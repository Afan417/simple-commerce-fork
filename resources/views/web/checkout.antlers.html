<div class="bg-white rounded-lg w-2/3 px-4 py-6">
    <h2 class="text-4xl font-bold mb-2 text-gray-800">Checkout</h2>

    {{ if {cart:count} == 0 }}
        <p>There's nothing in your cart. <a class="border-b-2 border-blue-600 text-blue-600 font-semibold" href="/products">Browse products</a>.</p>
    {{ else }}
        <div class="flex flex-col">
            {{ cart }}
                <a class="w-full bg-gray-100 my-1 p-4 flex flex-row items-center justify-between" href="/products/{{ slug }}">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">{{ quantity }} X {{ title }}</h2>

                        <form action="{{ commerce:route key='cart.delete' }}" method="post">
                            <input type="hidden" name="slug" value="{{ slug }}">

                            <button class="border-b-2 border-red-600 text-red-600 font-semibold text-xs">Remove</button>
                        </form>
                    </div>

                    <h3 class="text-lg font-semibold">{{ commerce:currency_symbol }}{{ price }}</h3>
                </a>
            {{ /cart }}

            <div class="w-full flex flex-row items-center justify-between p-4">
                <h2 class="text-lg font-bold text-gray-800">Total</h2>
                <p>{{ commerce:currency_symbol }}{{ cart:total }}</p>
            </div>

            <div class="w-full flex flex-row items-center justify-between mt-4">
                <div>
                    <button class="font-semibold text-gray-800 text-sm" @click="isCouponModalOpen = true">Redeem coupon</button>
                </div>

                <form action="{{ commerce:route key='cart.clear' }}" method="post">
                    <button class="font-semibold text-red-600 text-sm">Clear Cart</button>
                </form>
            </div>

            <form id="payment-form" class="mt-8" action="/checkout" method="post" @submit.prevent="submitCheckout">
                <h3 class="text-3xl font-bold mb-2 text-gray-800">Pay Now</h3>

                <input type="hidden" name="currency" value="{{ commerce:currency_code }}">
                <input type="hidden" name="payment_method" required>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Name</label>
                    <input class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" type="text" name="name" placeholder="Jon Smith" required>
                </div>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Email</label>
                    <input class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" type="email" name="email" placeholder="jon.smith@example.com" required>
                </div>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Address</label>
                    <textarea class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" name="address" required></textarea>
                </div>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Address</label>
                    <select class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" name="country" required>
                        <option value="uk" selected>United Kingdom</option>
                        <option value="us">United States</option>
                        <option value="ca">Canada</option>
                        <option value="fr">France</option>
                    </select>
                </div>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Zip code</label>
                    <input class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" type="text" name="zip_code" placeholder="99501" required>
                </div>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Name on Card</label>
                    <input class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" type="text" name="name_on_card" placeholder="Mr J Smith" required>
                </div>

                <div class="bg-gray-100 flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Card Details</label>
                    <div id="card-element" class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800"></div>
                </div>

                <div id="card-errors" role="alert"></div>
            </form>

            <div class="w-1/2 mx-auto">
                <button class="mt-2 bg-blue-600 px-6 py-2 hover:bg-blue-800 text-white font-semibold text-center text-lg w-full" type="submit" :disabled="isSubmitting">Pay</button>
            </div>
        </div>
    {{ /if }}

    <div
            v-if="isCouponModalOpen"
            class="fixed top-0 bottom-0 left-0 right-0 overflow-auto h-screen flex"
    >
        <div class="fixed top-0 bottom-0 left-0 right-0 z-50 bg-gray-900 opacity-75 h-screen"></div>

        <button class="fixed top-0 right-0 text-white font-bold text-xl m-4 z-50" @click="isCouponModalOpen = !isCouponModalOpen">Close</button>

        <div class="relative opacity-100 z-50 bg-white w-full max-w-md m-auto flex flex-col">
            <header class="text-2xl font-medium text-center bg-gray-100 w-full py-2 px-6 border-b">
                Redeem a coupon
            </header>

            <div class="p-6">
                <div class="flex flex-row items-center p-2">
                    <label class="w-1/3 text-gray-800 font-bold">Coupon</label>
                    <input class="w-2/3 border border-gray-600 p-1 text-semibold text-gray-800" type="text" v-model="coupon" required>
                </div>

                <div class="w-1/2 mx-auto mt-4">
                    <button class="mt-2 bg-blue-600 px-6 py-2 hover:bg-blue-800 text-white font-semibold text-center text-lg w-full" type="button" @click="redeemCoupon" :disabled="isSubmitting">Redeem</button>
                </div>
            </div>
        </div>
    </div>
</div>
